clear
% close all

a = [48.45	0.25	33.12	0.32	1.46	20.95	0.32	18.55	0.33	46.23	0.26	31.42	0.32	1.47	20.8	0.34	19.58	0.35	50.49	0.23	34.08	0.31	1.48	21.75	0.32	19.96	0.34	43.72	0.26	28.83	0.31	1.52	19.17	0.28	17.56	0.29	45.25	0.24	29.85	0.27	1.52	21.14	0.24	20.05	0.25
    48.62	0.27	33.59	0.32	1.45	22.13	0.32	20.25	0.35	45.13	0.26	30.5	0.33	1.48	20.94	0.32	19.54	0.33	48.34	0.24	33.02	0.32	1.46	21.68	0.32	19.91	0.36	44.91	0.27	30.03	0.31	1.5	19.97	0.28	18.43	0.28	41.84	0.26	27.79	0.29	1.51	19.83	0.24	18.6	0.24
    68.63	0.25	42.61	0.31	1.61	30.97	0.22	30.53	0.22	64.14	0.31	38.61	0.35	1.66	28.41	0.25	28.28	0.25	62.44	0.32	37.3	0.4	1.67	26.5	0.27	26.08	0.26	60.94	0.23	36.63	0.29	1.66	27.94	0.21	27.8	0.22	58.46	0.23	33.6	0.29	1.74	25.97	0.23	25.95	0.24
    62.62	0.29	38.83	0.33	1.61	27.79	0.24	27.36	0.24	62.44	0.26	38.2	0.3	1.63	27.81	0.24	27.17	0.25	65.83	0.24	39.93	0.3	1.65	29.66	0.24	29.17	0.25	55.73	0.23	33.62	0.27	1.66	25.29	0.2	25.13	0.2	56.49	0.23	32.29	0.28	1.75	24.23	0.21	23.85	0.22
    53.98	0.36	35.38	0.4	1.53	21.73	0.31	19.92	0.3	50.6	0.33	33.33	0.36	1.52	21.1	0.28	19.48	0.28	53.51	0.32	35.38	0.37	1.51	22.72	0.31	20.92	0.32	47.19	0.34	30.38	0.36	1.55	19.43	0.27	18.12	0.27	46.23	0.33	29.21	0.34	1.58	19.67	0.26	18.72	0.25
    49.49	0.37	30.49	0.42	1.62	18.48	0.33	16.7	0.32	42.82	0.33	28.49	0.37	1.5	17.93	0.32	16.78	0.33	48.58	0.3	31.26	0.37	1.55	19.57	0.3	18.17	0.29	41.52	0.3	26.42	0.35	1.57	16.84	0.29	15.49	0.3	40.06	0.28	24.92	0.34	1.61	16.99	0.28	16	0.27
    71.67	0.32	43.23	0.36	1.66	27.26	0.25	27.02	0.24	65.05	0.32	40.15	0.34	1.62	26.6	0.23	26.35	0.22	69.6	0.31	42.3	0.35	1.65	27.82	0.25	27.83	0.23	59.86	0.32	36.39	0.33	1.64	24.43	0.23	23.96	0.23	60.85	0.33	36.54	0.31	1.67	25.56	0.22	24.86	0.21
    67.48	0.32	43.02	0.33	1.57	27.48	0.26	26.85	0.25	61.63	0.32	39.66	0.32	1.55	26.91	0.24	26.46	0.24	63	0.32	39.71	0.33	1.59	26.49	0.24	26.24	0.24	58.03	0.31	37.71	0.32	1.54	25.72	0.23	25.57	0.21	57.59	0.31	37.42	0.29	1.54	27.11	0.21	26.7	0.21
    48.5	0.29	30.16	0.34	1.61	18.38	0.3	16.85	0.3	47.96	0.27	30.42	0.33	1.58	19.45	0.28	18.19	0.26	48.28	0.3	30.21	0.34	1.6	18.85	0.28	17.5	0.27	44.28	0.29	27.29	0.33	1.62	17.33	0.27	15.97	0.27	41.39	0.31	24.74	0.32	1.67	16.39	0.28	15.07	0.28
    55.5	0.28	33.43	0.36	1.66	19.68	0.32	17.57	0.32	62.06	0.29	38.51	0.34	1.61	24.62	0.24	23.18	0.21	58.28	0.27	35.69	0.34	1.63	21.02	0.28	19.21	0.27	51.39	0.28	30.43	0.34	1.69	18.39	0.29	16.69	0.29	51.55	0.29	29.53	0.33	1.75	19.33	0.25	18.14	0.25
    59.33	0.26	36.16	0.33	1.64	24.34	0.3	23.2	0.31	58.58	0.28	32.44	0.36	1.81	21.75	0.37	20.39	0.41	58.03	0.29	31.93	0.39	1.82	21.33	0.37	20.27	0.37	52.52	0.29	29.51	0.32	1.78	20.98	0.26	20.48	0.25	54.08	0.32	28.04	0.38	1.93	19.54	0.35	19.9	0.33
    70.02	0.28	41.49	0.31	1.69	28.01	0.23	26.33	0.23	65.99	0.27	37.68	0.31	1.75	26.28	0.25	24.61	0.25	70.63	0.27	39.48	0.36	1.79	26.5	0.36	24.55	0.41	61.26	0.28	34.45	0.31	1.78	24.4	0.23	23.57	0.21	64.41	0.28	35.28	0.3	1.83	26.65	0.22	26.19	0.21
    66.87	0.27	38.2	0.33	1.75	22.44	0.3	20.32	0.31	71.47	0.28	41.05	0.32	1.74	26.41	0.28	24.18	0.31	72.19	0.27	41.23	0.32	1.75	26.51	0.28	24.52	0.29	64.52	0.29	36.28	0.32	1.78	23.15	0.29	21.07	0.31	63.46	0.3	35.84	0.3	1.77	24.87	0.23	23.3	0.24
    63.83	0.3	39.35	0.3	1.62	25.04	0.26	22.94	0.27	71.8	0.31	43.24	0.3	1.66	29.09	0.24	26.88	0.24	68.8	0.3	41.43	0.3	1.66	27.17	0.25	24.96	0.27	60.29	0.31	36.23	0.3	1.66	24.01	0.25	22	0.26	61.47	0.32	35.14	0.3	1.75	24.85	0.23	23.4	0.25
    53.74	0.36	31.1	0.38	1.73	19.05	0.35	17.87	0.36	52.24	0.37	30.21	0.36	1.73	20.64	0.27	19.6	0.28	54.5	0.37	33.01	0.37	1.65	25.19	0.5	24.88	0.52	50.31	0.36	28.82	0.34	1.75	19.81	0.23	18.85	0.23	49.66	0.36	27.31	0.34	1.82	19.46	0.27	18.92	0.27
    66.1	0.41	39.43	0.35	1.68	27.47	0.27	26.18	0.27	66.07	0.4	39.69	0.32	1.66	28.9	0.21	27.94	0.21	68.29	0.37	41.04	0.32	1.66	28.81	0.22	27.44	0.22	55.48	0.41	32.64	0.35	1.7	23.17	0.26	21.88	0.25	61.09	0.4	35.29	0.31	1.73	26.87	0.21	25.87	0.21
    39.44	0.42	23.59	0.43	1.67	13.52	0.39	12.66	0.36	37.42	0.38	21.72	0.41	1.72	12.54	0.35	11.56	0.33	44.74	0.34	27.25	0.36	1.64	17.27	0.31	16.01	0.31	34.36	0.41	20.49	0.4	1.68	12.59	0.34	11.64	0.34	34.4	0.41	19.93	0.39	1.73	12.86	0.33	11.92	0.36
    45.63	0.38	27.1	0.38	1.68	16.03	0.32	14.54	0.32	41.27	0.38	24.74	0.36	1.67	15.89	0.28	14.84	0.29	43.96	0.35	26.59	0.35	1.65	16.07	0.31	14.66	0.32	39.38	0.39	23.48	0.36	1.68	14.88	0.29	13.78	0.29	38.51	0.41	21.66	0.35	1.78	14.62	0.3	13.52	0.31
    84.5	0.23	51.87	0.31	1.63	36.91	0.24	36.8	0.25	78.37	0.24	48.02	0.31	1.63	35.47	0.27	36.13	0.29	84.52	0.24	52.61	0.32	1.61	38.83	0.27	39.91	0.29	73.39	0.23	44.36	0.29	1.65	32.73	0.23	32.92	0.24	73.22	0.23	42.07	0.27	1.74	31.68	0.2	31.8	0.22
    81.61	0.22	48.18	0.3	1.69	33.18	0.24	32.1	0.24	76.89	0.22	45.31	0.29	1.7	33.04	0.22	33.14	0.23	81.57	0.23	50.64	0.29	1.61	37.43	0.26	37.62	0.29	73.59	0.23	42.94	0.28	1.71	31.33	0.22	31.26	0.23	74.6	0.22	42.94	0.27	1.74	32.86	0.21	32.65	0.23
    35.43	0.78	37.88	0.68	0.94	40.03	0.63	42.85	0.59	39.11	0.47	36.73	0.45	1.06	35.85	0.43	36.05	0.43	35.38	0.72	37.73	0.61	0.94	39.37	0.58	41.26	0.56	39.82	0.44	36.32	0.42	1.1	34.91	0.42	35.69	0.41	37.13	0.49	36.13	0.47	1.03	35.34	0.45	35.84	0.44
    47.6	0.42	29.93	0.4	1.59	19.35	0.3	17.73	0.29	42.34	0.43	26.8	0.39	1.58	17.78	0.29	16.25	0.29	46.63	0.39	29.36	0.39	1.59	18.94	0.34	17.47	0.34	40.19	0.43	24.85	0.39	1.62	16.38	0.33	15.12	0.33	38.23	0.5	23.24	0.44	1.64	16.73	0.32	15.77	0.33
    47.08	0.31	28.65	0.34	1.64	18.76	0.29	17.81	0.29	45.79	0.32	26.62	0.34	1.72	17.93	0.28	17.36	0.29	48.29	0.3	28.44	0.35	1.7	19.11	0.28	18.42	0.27	44.28	0.29	26.2	0.32	1.69	18.55	0.26	17.93	0.26	44.03	0.28	25.69	0.31	1.71	18.65	0.24	18.07	0.24
    66.69	0.25	39.08	0.31	1.71	26.14	0.24	25.08	0.24	66.38	0.27	37.7	0.34	1.76	25.53	0.27	24.65	0.28	65.46	0.27	36.86	0.35	1.78	25.2	0.3	24.17	0.32	59.87	0.27	33.61	0.32	1.78	23.41	0.23	22.55	0.24	58.81	0.27	32.33	0.3	1.82	23.84	0.23	23.15	0.22];

a(21:22,:) = [];


indx = 8;
% subplot(231);
% scatter(a(1:2:end,indx),a(2:2:end,indx),'filled')
%
%
% subplot(232);
% scatter(a(1:2:end,indx+9),a(2:2:end,indx+9),'filled')
%
% subplot(233);
%
% subplot(234);
%
% subplot(235);

ttl = {'SL','LL-bs2-mis','LL-bs2-sis','LL-bs31-mis','LL-bs31-mis-vfa'};

for s = 0:4
    subplot(2,3,s+1);
    tmp1 = a(1:2:end,indx+s*9);
    tmp2 = a(2:2:end,indx+s*9);
    tmp = [tmp1,tmp2];
    scatter(tmp1,tmp2,'filled')
    [r,p] = corr(tmp1,tmp2,'type','Spearman');
    CV = sqrt(mean((std([tmp1,tmp2],[],2)./mean([tmp1,tmp2],2)).^2))*100;
    title(sprintf('%s, Corr = %0.2f(%0.3f), CV = %0.1f %%',ttl{s+1},r,p,CV));
    set(gca,'fontsize',15);
    xlim([min(tmp(:))-3,max(tmp(:))+3]);
    ylim([min(tmp(:))-3,max(tmp(:))+3]);
    xlabel('Baseline');
    ylabel('Followup');
end

shg

close all

figure;
ind = [2,4,7,9];

ROIs = {'GM','WM','PV15','PV125'};
for s = 1:4
    subplot(2,2,s);
    hold on
    for t = 0:4
        scatter((t+1)*ones(22,1),a(:,ind(s)+t*9),'.');
    end
    xlim([0,6]);
    set(gca,'xtick',1:5,'xticklabel',ttl)
    xtickangle(45)
    title(sprintf('%s',ROIs{s}));
    set(gca,'fontsize',15);
end


figure;
hold on
for t = 0:4
    scatter((t+1)*ones(22,1),a(:,5+t*9),'filled');
    
end
xlim([0,6]);
title('GM/WM contrast');
set(gca,'xtick',1:5,'xticklabel',ttl);
set(gca,'fontsize',12)


